(function(S,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(S=typeof globalThis<"u"?globalThis:S||self,e(S.MyCalendar={},S.Vue))})(this,(function(S,e){"use strict";function R(f,D){const k=e.computed(()=>f.popupFields||[]),l=e.ref({...f.eventData}),p=e.ref([...f.eventData?.todos||[]]),r=e.ref([...f.eventData?.participants||[]]);e.watch(()=>f.eventData,n=>{n&&(l.value={...n},p.value=[...n.todos||[]],r.value=[...n.participants||[]])},{immediate:!0});const V=n=>n.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase()),C=e.computed(()=>k.value.length===0?l.value:Object.fromEntries(Object.entries(l.value).filter(([n])=>k.value.includes(n)))),T=(n,w)=>{l.value[n]=w,D("updateEvent",l.value)},d=e.ref(""),N=()=>{const n=d.value.trim();n&&(p.value.push(n),d.value="",D("update:todos",{todos:[...p.value],eventId:l.value.id}))},L=n=>{p.value.splice(n,1),D("update:todos",{todos:[...p.value],eventId:l.value.id})},b=e.ref("");return{editableEventData:l,popupFields:k,filteredEventData:C,formatKey:V,updateField:T,localTodos:p,newTodo:d,addTodo:N,removeTodo:L,localParticipants:r,newParticipant:b,addParticipant:()=>{const n=b.value.trim();n&&(r.value.push(n),b.value="",D("update:participants",{participants:[...r.value],eventId:l.value.id}))},removeParticipant:n=>{r.value.splice(n,1),D("update:participants",{participants:[...r.value],eventId:l.value.id})}}}const j={key:0,class:"popup"},Y={class:"top-right-icons"},K={class:"popup-title"},X={key:0},H={key:0,class:"popup-field"},G={class:"popup-label"},J=["onUpdate:modelValue","placeholder"],Q={class:"section"},Z={class:"popup-label"},ee={class:"list"},te=["onClick"],oe={class:"input-row"},ne={class:"section"},ae={class:"popup-label"},le={class:"list"},se=["onClick"],re={class:"input-row"},ie=e.defineComponent({__name:"Popup",props:{visible:{type:Boolean},closeButtonText:{},eventData:{},popupFields:{},todosLabel:{},participantsLabel:{},todos:{},participants:{},todoPlaceholder:{},participantPlaceholder:{}},emits:["submit-event","handle-delete","update-event","show-info","close-popup","update:todos","update:participants"],setup(f,{emit:D}){const k=f,l=e.computed(()=>k.todosLabel||"To-do"),p=e.computed(()=>k.participantsLabel||"Participant"),r=D,{editableEventData:V,filteredEventData:C,formatKey:T,localTodos:d,newTodo:N,addTodo:L,localParticipants:b,newParticipant:B,addParticipant:g}=R(k,r),n=()=>r("close-popup"),w=()=>r("handle-delete",k.eventData.id),M=()=>{const h={...V.value,todos:d.value,participants:b.value};r("update-event",h),r("update:todos",{todos:d.value,eventId:k.eventData.id}),r("update:participants",{participants:b.value,eventId:k.eventData.id}),r("close-popup")},_=e.ref(null),E={x:0,y:0},$=h=>{if(!_.value)return;const i=_.value;E.x=h.clientX-i.getBoundingClientRect().left,E.y=h.clientY-i.getBoundingClientRect().top;const y=u=>{i.style.left=`${u.clientX-E.x}px`,i.style.top=`${u.clientY-E.y}px`,i.style.position="absolute",i.style.transform="none"},m=()=>{window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",m)};window.addEventListener("mousemove",y),window.addEventListener("mouseup",m)},v=h=>{d.value.splice(h,1),r("update:todos",{todos:[...d.value],eventId:V.value.id})},A=h=>{b.value.splice(h,1),r("update:participants",{participants:[...b.value],eventId:V.value.id})};return(h,i)=>{const y=e.resolveComponent("font-awesome-icon");return f.visible?(e.openBlock(),e.createElementBlock("div",j,[e.createElementVNode("div",{class:"popup-content",ref_key:"popupRef",ref:_,onMousedown:$},[e.createElementVNode("div",Y,[e.createElementVNode("button",{class:"icon-button",onClick:w,title:"Delete"},[e.createVNode(y,{icon:["fas","trash"]})]),e.createElementVNode("button",{class:"icon-button",onClick:n,title:"Close"},[e.createVNode(y,{icon:["fas","times"]})])]),e.createElementVNode("h2",K,e.toDisplayString(e.unref(V).title),1),f.eventData&&Object.keys(f.eventData).length?(e.openBlock(),e.createElementBlock("div",X,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(C),(m,u)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:u},[u!=="title"?(e.openBlock(),e.createElementBlock("div",H,[e.createElementVNode("label",G,e.toDisplayString(e.unref(T)(String(u))),1),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":F=>e.unref(V)[u]=F,class:"popup-input",placeholder:e.unref(T)(String(u))},null,8,J),[[e.vModelText,e.unref(V)[u]]])])):e.createCommentVNode("",!0)],64))),128))])):e.createCommentVNode("",!0),e.createElementVNode("div",Q,[e.createElementVNode("label",Z,e.toDisplayString(l.value),1),e.createElementVNode("ul",ee,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(m,u)=>(e.openBlock(),e.createElementBlock("li",{key:u},[e.createTextVNode(e.toDisplayString(m)+" ",1),e.createElementVNode("button",{onClick:F=>v(u)},[e.createVNode(y,{icon:["fas","trash"]})],8,te)]))),128))]),e.createElementVNode("div",oe,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":i[0]||(i[0]=m=>e.isRef(N)?N.value=m:null),placeholder:"New To-do...",class:"popup-input"},null,512),[[e.vModelText,e.unref(N)]]),e.createElementVNode("button",{class:"add-inline-button",onClick:i[1]||(i[1]=(...m)=>e.unref(L)&&e.unref(L)(...m))},[e.createVNode(y,{icon:["fas","plus"]})])])]),e.createElementVNode("div",ne,[e.createElementVNode("label",ae,e.toDisplayString(p.value),1),e.createElementVNode("ul",le,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(b),(m,u)=>(e.openBlock(),e.createElementBlock("li",{key:u},[e.createTextVNode(e.toDisplayString(m)+" ",1),e.createElementVNode("button",{onClick:F=>A(u)},[e.createVNode(y,{icon:["fas","trash"]})],8,se)]))),128))]),e.createElementVNode("div",re,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":i[2]||(i[2]=m=>e.isRef(B)?B.value=m:null),placeholder:"Add Participant ...",class:"popup-input"},null,512),[[e.vModelText,e.unref(B)]]),e.createElementVNode("button",{class:"add-inline-button",onClick:i[3]||(i[3]=(...m)=>e.unref(g)&&e.unref(g)(...m))},[e.createVNode(y,{icon:["fas","user-plus"]})])])]),e.createElementVNode("div",{class:"popup-footer"},[e.createElementVNode("button",{class:"save-button",onClick:M},"Speichern")])],544)])):e.createCommentVNode("",!0)}}}),de="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2050%2050'%20width='50px'%20height='50px'%3e%3cpath%20d='M%2025%202%20C%2012.309295%202%202%2012.309295%202%2025%20C%202%2037.690705%2012.309295%2048%2025%2048%20C%2037.690705%2048%2048%2037.690705%2048%2025%20C%2048%2012.309295%2037.690705%202%2025%202%20z%20M%2025%204%20C%2036.609824%204%2046%2013.390176%2046%2025%20C%2046%2036.609824%2036.609824%2046%2025%2046%20C%2013.390176%2046%204%2036.609824%204%2025%20C%204%2013.390176%2013.390176%204%2025%204%20z%20M%2025%2011%20A%203%203%200%200%200%2022%2014%20A%203%203%200%200%200%2025%2017%20A%203%203%200%200%200%2028%2014%20A%203%203%200%200%200%2025%2011%20z%20M%2021%2021%20L%2021%2023%20L%2022%2023%20L%2023%2023%20L%2023%2036%20L%2022%2036%20L%2021%2036%20L%2021%2038%20L%2022%2038%20L%2023%2038%20L%2027%2038%20L%2028%2038%20L%2029%2038%20L%2029%2036%20L%2028%2036%20L%2027%2036%20L%2027%2021%20L%2026%2021%20L%2022%2021%20L%2021%2021%20z'/%3e%3c/svg%3e",ce=["for"],pe={key:0},me=["id","onUpdate:modelValue"],ue=["value"],fe={key:1},Ee=["id","onUpdate:modelValue","type"],be={class:"form-group"},ge={for:"start",class:"form-label"},he={class:"form-group"},ke={for:"end",class:"form-label"},ye={class:"form-group"},Ve={for:"date",class:"form-label"},De={type:"submit",class:"submit-button"},Se={class:"calendar"},Ne={class:"navigation"},_e={class:"current-week"},Le={class:"hours-and-days"},Be={class:"hours"},we={class:"weekdays-container"},Te={class:"weekdays"},Ce={class:"days"},Me=["onDrop"],$e=["onDragstart"],Fe=["onClick"],xe=["src"],W=e.defineComponent({__name:"ScheduleForm",props:{schedules:{},additionalFields:{},customClass:{default:""},customStyles:{default:()=>({})},weekdays:{default:()=>["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]},eventTitleColor:{default:"#000"},eventTitleSize:{default:"16px"},popupFields:{default:()=>[]},labelsAndSettings:{default:()=>({startTimeLabel:"Start Time",endTimeLabel:"End Time",dateLabel:"Date",submitButtonText:"Add Entry",calendarWeekLabel:"CW"})},placeholderSettings:{default:()=>({})},popupVisible:{type:Boolean,default:!1},popupEvent:{default:null}},emits:["submit-event","handle-delete","update-event","show-info","close-popup","update:todos","update:participants"],setup(f,{expose:D,emit:k}){const l=f,p=k,r=e.ref(!1),V=e.computed(()=>l.weekdays||["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]),C=e.computed(()=>l.eventTitleColor||"#000"),T=e.computed(()=>l.eventTitleSize||"16px"),d=e.computed(()=>({startTimeLabel:l.labelsAndSettings?.startTimeLabel||"Start Time",endTimeLabel:l.labelsAndSettings?.endTimeLabel||"End Time",dateLabel:l.labelsAndSettings?.dateLabel||"Date",submitButtonText:l.labelsAndSettings?.submitButtonText||"Add Entry",calendarWeekLabel:l.labelsAndSettings?.calendarWeekLabel||"CW",todosLabel:l.labelsAndSettings?.todosLabel,participantsLabel:l.labelsAndSettings?.participantsLabel})),N=e.computed(()=>l.placeholderSettings||{}),L=e.ref(l.schedules),b=e.ref(l.additionalFields),B=e.ref(Array.from({length:24},(a,t)=>t.toString().padStart(2,"0")+":00")),g=e.ref({}),n=e.ref({start:"",end:"",date:"",color:""}),w=e.computed(()=>l.popupVisible),M=e.computed(()=>l.popupEvent),_=e.ref(0),E=e.ref(null),$=a=>{const t=a||n.value,o={start:t.start,end:t.end,date:t.date,info:t.info,color:t.color};l.additionalFields.forEach(s=>{o[s.model]=t[s.model]}),p("submit-event",o),h(),Object.keys(n.value).forEach(s=>{n.value[s]=""})},v=a=>{p("update-event",a)},A=()=>{!b.value.length||!L.value.length||(g.value={},L.value.forEach(a=>{const t=a.date;g.value[t]||(g.value[t]=[]),g.value[t].push(a)}))};e.watchEffect(A);const h=()=>{Object.keys(n.value).forEach(a=>{n.value[a]=""})},i=a=>{const t=new Date,o=t.getDay(),s=a+1-o+_.value*7,c=new Date(t);return c.setDate(t.getDate()+s),c.toISOString().substring(0,10)},y=()=>{const a=new Date,t=new Date(a.getFullYear(),0,1),o=(a.getTime()-t.getTime())/864e5+_.value*7;return Math.ceil((o+t.getDay()+1)/7)},m=()=>_.value-=1,u=()=>_.value+=1,F=a=>{const t=x(a.start),o=x(a.end),s=t.totalMinutes*40/60,c=(o.totalMinutes-t.totalMinutes)*40/60;return{backgroundColor:a.color||"var(--calendar-primary-color)",top:`${s}px`,height:`${c}px`,position:"absolute",left:0,right:0,zIndex:1,borderRadius:"var(--event-border-radius)"}},x=a=>{const[t,o]=a.split(":").map(Number);return{h:t,m:o,totalMinutes:t*60+o}},Pe=(a,t)=>x(t).totalMinutes-x(a).totalMinutes,ve=(a,t)=>{const o=x(a).totalMinutes+t,s=Math.floor(o/60).toString().padStart(2,"0"),c=(o%60).toString().padStart(2,"0");return`${s}:${c}`},Ae=(a,t)=>{E.value=t},Ue=()=>{E.value=null},We=(a,t)=>{if(!E.value)return;const s=a.currentTarget.getBoundingClientRect(),c=a.clientY-s.top,z=60/40,P=Math.round(c*z/15)*15,I=`${String(Math.floor(P/60)).padStart(2,"0")}:${String(P%60).padStart(2,"0")}`,qe=Pe(E.value.start,E.value.end),Re=ve(I,qe),U=i(t),O={...E.value,start:I,end:Re,date:U};p("update-event",O);const q=E.value.date;g.value[q]=g.value[q]?.filter(je=>je.id!==E.value.id)||[],g.value[U]=[...g.value[U]||[],O],E.value=null},ze=a=>{p("show-info",a)},Ie=()=>{p("close-popup")},Oe=a=>p("handle-delete",a);return e.onMounted(()=>{l.additionalFields.forEach(t=>{n.value[t.model]=""}),window.matchMedia?.("(prefers-color-scheme: dark)")?.matches&&(r.value=!0)}),D({newEvent:n,addEvent:$,resetForm:h}),(a,t)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["calendar-theme",f.customClass,{dark:r.value}]),style:e.normalizeStyle(f.customStyles)},[e.renderSlot(a.$slots,"form",{newEvent:n.value,addEvent:$,additionalFields:b.value,labels:d.value,resetForm:h},()=>[e.createElementVNode("form",{class:"form-container",onSubmit:e.withModifiers($,["prevent"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.value,o=>(e.openBlock(),e.createElementBlock("div",{key:o.id,class:"form-group"},[e.createElementVNode("label",{for:o.id,class:"form-label"},e.toDisplayString(o.label)+":",9,ce),o.type==="select"?(e.openBlock(),e.createElementBlock("div",pe,[e.withDirectives(e.createElementVNode("select",{id:o.id,"onUpdate:modelValue":s=>n.value[o.model]=s,required:"",class:"form-select"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.options,s=>(e.openBlock(),e.createElementBlock("option",{key:s.id,value:s},e.toDisplayString(s.name||`${s.first_name} ${s.last_name}`),9,ue))),128))],8,me),[[e.vModelSelect,n.value[o.model]]])])):(e.openBlock(),e.createElementBlock("div",fe,[e.withDirectives(e.createElementVNode("input",{id:o.id,"onUpdate:modelValue":s=>n.value[o.model]=s,type:o.type,required:"",class:"form-input"},null,8,Ee),[[e.vModelDynamic,n.value[o.model]]])]))]))),128)),e.createElementVNode("div",be,[e.createElementVNode("label",ge,e.toDisplayString(d.value.startTimeLabel)+":",1),e.withDirectives(e.createElementVNode("input",{id:"start","onUpdate:modelValue":t[0]||(t[0]=o=>n.value.start=o),type:"time",required:"",class:"form-input"},null,512),[[e.vModelText,n.value.start]])]),e.createElementVNode("div",he,[e.createElementVNode("label",ke,e.toDisplayString(d.value.endTimeLabel)+":",1),e.withDirectives(e.createElementVNode("input",{id:"end","onUpdate:modelValue":t[1]||(t[1]=o=>n.value.end=o),type:"time",required:"",class:"form-input"},null,512),[[e.vModelText,n.value.end]])]),e.createElementVNode("div",ye,[e.createElementVNode("label",Ve,e.toDisplayString(d.value.dateLabel)+":",1),e.withDirectives(e.createElementVNode("input",{id:"date","onUpdate:modelValue":t[2]||(t[2]=o=>n.value.date=o),type:"date",required:"",class:"form-input"},null,512),[[e.vModelText,n.value.date]])]),e.createElementVNode("button",De,e.toDisplayString(d.value.submitButtonText),1)],32)]),e.createElementVNode("div",Se,[e.createElementVNode("div",Ne,[e.createElementVNode("button",{class:"arrow-button",onClick:m},"<"),e.createElementVNode("span",_e,e.toDisplayString(d.value.calendarWeekLabel)+" "+e.toDisplayString(y()),1),e.createElementVNode("button",{class:"arrow-button",onClick:u},">")]),e.createElementVNode("div",Le,[e.createElementVNode("div",Be,[t[6]||(t[6]=e.createElementVNode("div",{class:"empty-slot"},null,-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.value,o=>(e.openBlock(),e.createElementBlock("div",{key:o,class:"hour"},e.toDisplayString(o),1))),128))]),e.createElementVNode("div",we,[e.createElementVNode("ul",Te,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.value,(o,s)=>(e.openBlock(),e.createElementBlock("li",{key:s,class:"weekday"},[e.createElementVNode("span",null,e.toDisplayString(o),1),e.createElementVNode("span",null,e.toDisplayString(i(s)),1)]))),128))]),e.createElementVNode("div",Ce,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(7,(o,s)=>e.createElementVNode("div",{key:s,class:"day",onDragover:t[3]||(t[3]=e.withModifiers(()=>{},["prevent"])),onDrop:c=>We(c,s)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.value,c=>(e.openBlock(),e.createElementBlock("div",{key:c,class:"hour"}))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.value[i(s)]||[],(c,z)=>(e.openBlock(),e.createElementBlock("div",{key:c.id,class:"event",style:e.normalizeStyle(F(c)),draggable:"true",onDragstart:P=>Ae(P,c),onDragend:Ue},[e.createElementVNode("span",{style:e.normalizeStyle({color:C.value,fontSize:T.value})},e.toDisplayString(c.title),5),t[7]||(t[7]=e.createElementVNode("br",null,null,-1)),e.createElementVNode("button",{class:"info-button",onClick:P=>ze(c)},[e.createElementVNode("img",{src:e.unref(de),alt:"info",class:"small-logo"},null,8,xe)],8,Fe)],44,$e))),128))],40,Me)),64))])])])]),a.$slots["popup-calendar"]?e.renderSlot(a.$slots,"popup-calendar",{key:0}):(e.openBlock(),e.createBlock(ie,{key:1,visible:w.value,eventData:M.value,popupFields:f.popupFields||[],closeButtonText:"Close",todosLabel:d.value.todosLabel||"To-Do",participantsLabel:d.value.participantsLabel||"Teammates",todos:M.value?.todos||[],participants:M.value?.participants||[],todoPlaceholder:N.value.todo||"New To-do...",participantPlaceholder:N.value.participant||"Add Participant...","onUpdate:todos":t[4]||(t[4]=o=>p("update:todos",o)),"onUpdate:participants":t[5]||(t[5]=o=>p("update:participants",o)),onClosePopup:Ie,onHandleDelete:Oe,onUpdateEvent:v},null,8,["visible","eventData","popupFields","todosLabel","participantsLabel","todos","participants","todoPlaceholder","participantPlaceholder"]))],6))}});S.ScheduleForm=W,S.default=W,Object.defineProperties(S,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
